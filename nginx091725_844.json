{"platform":{"name":"debian","release":"12.12","target_id":"da39a3ee-5e6b-5b0d-b255-bfef95601890"},"profiles":[{"name":"my_nginx","version":"0.1.0","sha256":"075508782aa05470fe81cdc5d7b3e97477bbf4ded22313b22f121ef8dc76a4a4","title":"InSpec Profile","maintainer":"The Authors","summary":"An InSpec Compliance Profile","license":"Apache-2.0","copyright":"The Authors","copyright_email":"you@example.com","supports":[{"platform":"os"}],"attributes":[{"name":"nginx_version","options":{"type":"String","value":"1.27.0"}},{"name":"nginx_modules","options":{"type":"Array","value":["http_ssl","stream_ssl","mail_ssl"]}},{"name":"admin_users","options":{"type":"Array","value":["admin","bob"]}}],"groups":[{"id":"controls/example.rb","controls":["nginx-version","nginx-modules","nginx-conf-file","nginx-conf-perms","nginx-shell-access","nginx-interview"]}],"controls":[{"id":"nginx-version","title":"NGINX version","desc":"The required version of NGINX should be installed.","descriptions":[{"label":"default","data":"The required version of NGINX should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-version' do\n  impact 1.0\n  title 'NGINX version'\n  desc 'The required version of NGINX should be installed.'\n  describe nginx do\n    its('version') { should cmp >= input('nginx_version') }\n  end\nend\n","source_location":{"line":1,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment version is expected to cmp >= \"1.27.0\"","run_time":0.0004452,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"}],"status":"passed"},{"id":"nginx-modules","title":"NGINX modules","desc":"The required NGINX modules should be installed.","descriptions":[{"label":"default","data":"The required NGINX modules should be installed."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-modules' do\n  impact 1.0\n  title 'NGINX modules'\n  desc 'The required NGINX modules should be installed.'\n\n  nginx_modules = input('nginx_modules')\n  \n  describe nginx do\n    nginx_modules.each do |current_module|\n      its('modules') { should include current_module }\n    end\n  end\nend\n","source_location":{"line":9,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"http_ssl\"","run_time":0.003530878,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"stream_ssl\"","run_time":0.000152324,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"},{"status":"passed","code_desc":"Nginx Environment modules is expected to include \"mail_ssl\"","run_time":0.000125223,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"nginx","resource_params":"[]","resource_id":"/usr/sbin/nginx"}],"status":"passed"},{"id":"nginx-conf-file","title":"NGINX configuration file","desc":"The NGINX config file should exist as a file.","descriptions":[{"label":"default","data":"The NGINX config file should exist as a file."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-conf-file' do\n  impact 1.0\n  title 'NGINX configuration file'\n  desc 'The NGINX config file should exist as a file.'\n  describe file('/etc/nginx/nginx.conf') do\n    it { should be_file }\n  end\nend\n","source_location":{"line":22,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be file","run_time":0.060983288,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"}],"status":"passed"},{"id":"nginx-conf-perms","title":"NGINX configuration","desc":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.","descriptions":[{"label":"default","data":"The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-conf-perms' do\n  impact 1.0\n  title 'NGINX configuration'\n  desc 'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'\n  describe file('/etc/nginx/nginx.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","source_location":{"line":30,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be owned by \"root\"","run_time":0.010216067,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected to be grouped into \"root\"","run_time":0.009499252,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be readable by others","run_time":0.047026436,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be writable by others","run_time":0.000305991,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"},{"status":"passed","code_desc":"File /etc/nginx/nginx.conf is expected not to be executable by others","run_time":0.0001985,"start_time":"2025-09-17T13:45:44+00:00","resource_class":"file","resource_params":"[\"/etc/nginx/nginx.conf\"]","resource_id":"/etc/nginx/nginx.conf"}],"status":"passed"},{"id":"nginx-shell-access","title":"NGINX shell access","desc":"The NGINX shell access should be restricted to admin users.","descriptions":[{"label":"default","data":"The NGINX shell access should be restricted to admin users."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-shell-access' do\n  impact 1.0\n  title 'NGINX shell access'\n  desc 'The NGINX shell access should be restricted to admin users.'\n  describe users.shells(/bash/).usernames do\n    it { should be_in [input(admin_users)]}\n  end\nend\n","source_location":{"line":42,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"failed","code_desc":"[\"root\"] ","run_time":0.010269803,"start_time":"2025-09-17T13:45:44+00:00","message":"undefined local variable or method `admin_users' for #<RSpec::ExampleGroups::Root \"example at my_nginx/controls/example.rb:47\">","exception":"NameError","backtrace":["/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-expectations-3.13.3/lib/rspec/matchers.rb:968:in `method_missing'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:767:in `method_missing'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/rspec_extensions.rb:78:in `method_missing'","my_nginx/controls/example.rb:47:in `block (3 levels) in load_with_context'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:263:in `instance_exec'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:263:in `block in run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:486:in `block in run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/hooks.rb:486:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:468:in `with_around_example_hooks'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example.rb:259:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:646:in `block in run_examples'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:642:in `map'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:642:in `run_examples'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/example_group.rb:607:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in `map'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/configuration.rb:2097:in `with_suite_hooks'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:116:in `block in run_specs'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/reporter.rb:74:in `report'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/rspec-core-3.13.2/lib/rspec/core/runner.rb:115:in `run_specs'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/runner_rspec.rb:97:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/runner.rb:241:in `run_tests'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/runner.rb:194:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/cli.rb:410:in `block in exec'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/feature/runner.rb:24:in `with_feature'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/feature.rb:6:in `with_feature'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/cli.rb:395:in `exec'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.2/lib/thor/command.rb:27:in `run'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.2/lib/thor/invocation.rb:127:in `invoke_command'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.2/lib/thor.rb:392:in `dispatch'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/thor-1.2.2/lib/thor/base.rb:485:in `start'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/inspec-core-6.8.24/lib/inspec/base_cli.rb:40:in `start'","/opt/cinc-auditor/embedded/lib/ruby/gems/3.1.0/gems/cinc-auditor-bin-6.8.24/bin/cinc-auditor:12:in `<top (required)>'","/opt/cinc-auditor/bin/cinc-auditor:290:in `load'","/opt/cinc-auditor/bin/cinc-auditor:290:in `<main>'"],"resource_class":"Object","resource_params":"[]","resource_id":""}],"status":"error"},{"id":"nginx-interview","title":"NGINX interview","desc":"NGINX admins should have documentation on security procedures.","descriptions":[{"label":"default","data":"NGINX admins should have documentation on security procedures."}],"impact":1.0,"refs":[],"tags":{},"code":"control 'nginx-interview' do\n  impact 1.0\n  title 'NGINX interview'\n  desc 'NGINX admins should have documentation on security procedures.'\n\n  describe \"Manual Review\" do\n    skip \"This control must be manually reviewed.\"\n  end\nend","source_location":{"line":50,"ref":"my_nginx/controls/example.rb"},"waiver_data":{},"results":[{"status":"skipped","code_desc":"Manual Review","run_time":1.071e-05,"start_time":"2025-09-17T13:45:44+00:00","resource":"","skip_message":"This control must be manually reviewed.","resource_class":"Object","resource_params":"[]","resource_id":"Manual Review"}],"status":"not_reviewed"}],"status":"loaded","status_message":""}],"statistics":{"duration":0.147340533},"version":"6.8.24"}